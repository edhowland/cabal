# read_list.cb - implements Cabal read_list proc wrt read proc
[:define, :read_list, [:lambda, [:tokens, :list],
  [:let, [[:atom, [:car, :tokens]]],
    [:cond,
      [[:eql?, :atom, [:quote, RParen]], [->(l) { l.reverse }, :list]],
      [:else, [:cons, :atom, [:read_list, [:cdr, :tokens], :list]]]
    ]
  ]
]]